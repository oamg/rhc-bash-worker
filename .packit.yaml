specfile_path: packaging/rhc-bash-worker.spec
upstream_package_name: rhc-bash-worker
downstream_package_name: rhc-bash-worker
upstream_project_url: https://github.com/oamg/rhc-bash-worker

srpm_build_deps: []

jobs:
- job: copr_build
  trigger: pull_request
  owner: "@oamg"
  project: rhc-bash-worker
  targets:
  - epel-7-x86_64
  actions:
    # do not get the version from a tag (git describe) but from the spec file
    get-current-version:
    - grep -oP '^Version:\s+\K\S+' packaging/rhc-bash-worker.spec

- job: copr_build
  trigger: commit
  branch: main
  owner: "@oamg"
  project: rhc-bash-worker
  targets:
  - epel-7-x86_64
  actions:
    # bump spec so we get release starting with 2 and hence all the default branch builds will
    # have higher NVR than all the PR builds
    post-upstream-clone:
    - rpmdev-bumpspec --comment='latest upstream build' ./packaging/rhc-bash-worker.spec
    # do not get the version from a tag (git describe) but from the spec file
    get-current-version:
    - grep -oP '^Version:\s+\K\S+' packaging/rhc-bash-worker.spec
